# -*- coding: utf-8 -*-
"""SAI_out-of-box_v201912.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/19-3zZuya-5hrCPybmACgUy4Pqh1E0rHp

This notebook shows how to run a **SAI client on Google Colab's NVIDIA Tesla K80 GPU**. Thanks to [djinnome from GitHub who figured it out.](https://github.com/glinscott/leela-chess/issues/284).

Updated to work with NVIDIA driver 396.44.

Run each cell in order, waiting for the previous one to finish before running the next.

The scripts and cell layout may be messy/redundant, but this should work.
"""

import subprocess
if subprocess.run(["nvidia-smi", "-L"]).returncode != 0:
  assert False, "No GPU available!"

!apt-get update
!apt-get install -y --fix-missing --no-install-recommends cuda-compiler-9-2 cuda-cublas-dev-9-2 cuda-cudart-dev-9-2

!wget http://developer.download.nvidia.com/compute/redist/cudnn/v7.3.1/cudnn-9.2-linux-x64-v7.3.1.20.tgz
!cd /usr/local && tar -xzvf /content/cudnn-9.2-linux-x64-v7.3.1.20.tgz
!chmod a+r /usr/local/cuda/lib64/libcudnn*

!git clone https://github.com/startnoob/sai_in_gg.git

"""Congratulations! We can contribute to SAI project by running code blocks below.Please replace $\$username$ and $\$passwd$ into yours，-m help you to limit selfplays number.

恭喜你！然后我们运行下面代码跑谱：请替换 $\$username$ 和 $\$passwd$为你的，修改 -m 参数可以设定跑谱数量上限。
"""

!cd sai_in_gg && ./autogtp --url http://sai.unich.it/ --username $username --password $passwd -m100| grep minute